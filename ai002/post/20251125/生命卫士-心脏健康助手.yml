app:
  description: ç”Ÿå‘½å«å£«-å¿ƒè„å¥åº·åŠ©æ‰‹ (Dify 1.1.0 Compatible)
  icon: ðŸ’“
  icon_background: '#FFEAD5'
  mode: workflow
  name: ç”Ÿå‘½å«å£«-å¿ƒè„å¥åº·åŠ©æ‰‹
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/siliconflow:0.0.8@217f973bd7ced1b099c2f0c669f1356bdf4cc38b8372fd58d7874f9940b95de3
kind: app
version: 0.1.5
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1766026350824-source-1766026413584-target
      source: '1766026350824'
      sourceHandle: source
      target: '1766026413584'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1766026413584-source-1766026721777-target
      source: '1766026413584'
      sourceHandle: source
      target: '1766026721777'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1766026721777-source-1766027016360-target
      source: '1766026721777'
      sourceHandle: source
      target: '1766027016360'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: end
      id: 1766027016360-source-1766027040263-target
      source: '1766027016360'
      sourceHandle: source
      target: '1766027040263'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: é—®é¢˜
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: question
      height: 90
      id: '1766026350824'
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-ai/DeepSeek-V3
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: d7efb4bf-5ea5-483c-b563-38c67baada77
          role: system
          text: "ä½ çš„ä»»åŠ¡æ˜¯ä»Žç”¨æˆ·çš„è‡ªç„¶è¯­è¨€å¯¹è¯ä¸­æå–å¥åº·æŒ‡æ ‡ï¼Œå¹¶è¾“å‡ºä¸º JSON æ ¼å¼ã€‚\\n\\néœ€è¦æå–çš„å­—æ®µï¼ˆå¦‚æžœç”¨æˆ·æœªæåŠï¼Œè¯·è®¾ä¸º null\
            \ æˆ–é»˜è®¤å€¼ï¼‰ï¼š\\n\\\n            - uric_acid (å°¿é…¸å€¼, int)\\n- bp_systolic (æ”¶ç¼©åŽ‹/é«˜åŽ‹,\
            \ int)\\n- spo2 (è¡€æ°§é¥±å’Œåº¦, int)\\n- heart_rate (å¿ƒçŽ‡, int)\\n- gender (æ€§åˆ«,\
            \ string: male/female)\\n\\\n            - symptoms (ç—‡çŠ¶æè¿°, string)\\n\\\
            nç¤ºä¾‹è¾“å…¥ï¼šâ€œæˆ‘ç”·ï¼Œè¡€åŽ‹150ï¼Œå¤´æœ‰ç‚¹æ™•â€\\nç¤ºä¾‹è¾“å‡ºï¼š\\n{\\n  \\\"uric_acid\\\": 0,\\n  \\\"bp_systolic\\\
            \": 150,\\n  \\\"spo2\\\": 99,\\n  \\\"heart_rate\\\": 0,\\n \\\n    \
            \        \\ \\\"gender\\\": \\\"male\\\",\\n  \\\"symptoms\\\": \\\"å¤´æ™•\\\
            \"\\n}"
        - id: 9f42c5cc-3207-4274-93a1-55b288e4c499
          role: user
          text: '{{#1766026350824.question#}}'
        selected: true
        title: 1. æ•°æ®æå– (LLM)
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1766026413584'
      position:
        x: 384
        y: 282
      positionAbsolute:
        x: 384
        y: 282
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\n\ndef main(json_str):\n    try:\n        # å®¹é”™å¤„ç†ï¼šåˆ¤æ–­è¾“å…¥ç±»åž‹å¹¶æ¸…æ´—\
          \ JSON å­—ç¬¦ä¸²\n        if isinstance(json_str, dict):\n            data = json_str\n\
          \        else:\n            # æ¸…ç†å¯èƒ½åŒ…å«çš„ markdown ä»£ç å—æ ‡è¯†\n            clean_str\
          \ = json_str.replace('```json', '').replace('```', '')\n            data\
          \ = json.loads(clean_str)\n\n        risks = []\n        context = []\n\n\
          \        # 1. ç—›é£Ž/é«˜å°¿é…¸åˆ¤æ–­ï¼ˆé˜ˆå€¼ï¼š> 420ï¼‰\n        ua = data.get('uric_acid', 0)\n\
          \        if ua and ua > 420:\n            risks.append(\"é«˜å°¿é…¸\")\n      \
          \      context.append(f\"å°¿é…¸å€¼ {ua} (è¶…æ ‡)\")\n\n        # 2. é«˜è¡€åŽ‹åˆ¤æ–­ï¼ˆæ”¶ç¼©åŽ‹é˜ˆå€¼ï¼š>\
          \ 140ï¼‰\n        sbp = data.get('bp_systolic', 0)\n        if sbp and sbp\
          \ > 140:\n            risks.append(\"é«˜è¡€åŽ‹\")\n            context.append(f\"\
          æ”¶ç¼©åŽ‹ {sbp} (åé«˜)\")\n\n        # 3. å¿ƒçŽ‡å¼‚å¸¸åˆ¤æ–­ï¼ˆé˜ˆå€¼ï¼š> 100 æˆ– < 50ï¼‰\n        hr =\
          \ data.get('heart_rate', 0)\n        if hr and (hr > 100 or hr < 50):\n\
          \            risks.append(\"å¿ƒçŽ‡å¼‚å¸¸\")\n            context.append(f\"å¿ƒçŽ‡ {hr}\
          \ (éœ€å…³æ³¨)\")\n\n        # 4. ä½Žè¡€æ°§åˆ¤æ–­ï¼ˆé˜ˆå€¼ï¼š< 95ï¼‰\n        spo2 = data.get('spo2',\
          \ 99)\n        if spo2 and spo2 < 95:\n            risks.append(\"ä½Žè¡€æ°§\"\
          )\n            context.append(f\"è¡€æ°§ {spo2}% (åä½Ž)\")\n\n        # æ— å¼‚å¸¸æ—¶çš„é»˜è®¤æ ‡ç­¾\n\
          \        if not risks:\n            risks.append(\"æ•°æ®æ­£å¸¸æˆ–æœªæä¾›\")\n\n     \
          \   return {\n            \"risk_tags\": \",\".join(risks),\n          \
          \  \"analysis\": \";\".join(context),\n            \"raw_data\": str(data)\n\
          \        }\n\n    except Exception as e:\n        # å¼‚å¸¸å¤„ç†ï¼šè¿”å›žè§£æžé”™è¯¯ä¿¡æ¯\n    \
          \    return {\n            \"risk_tags\": \"è§£æžé”™è¯¯\",\n            \"analysis\"\
          : str(e),\n            \"raw_data\": str(\"\")\n        }"
        code_language: python3
        desc: Pythoné€»è¾‘åˆ¤æ–­
        outputs:
          analysis:
            children: null
            type: string
          raw_data:
            children: null
            type: string
          risk_tags:
            children: null
            type: string
        selected: false
        title: 2. é£Žé™©è®¡ç®— (Code)
        type: code
        variables:
        - value_selector:
          - '1766026413584'
          - text
          variable: json_str
      height: 82
      id: '1766026721777'
      position:
        x: 688
        y: 282
      positionAbsolute:
        x: 688
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-ai/DeepSeek-V3
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: e5269793-c635-45ab-9d3e-6ffb8678c871
          role: system
          text: "ä½ æ˜¯ä¸€åèµ„æ·±å¥åº·ç®¡ç†å¸ˆã€‚è¯·æ ¹æ®ä»¥ä¸‹æ•°æ®å’Œé£Žé™©æ ‡ç­¾ï¼Œä¸ºç”¨æˆ·æä¾›å»ºè®®ã€‚\\n\\nç”¨æˆ·æ•°æ®ï¼š{{#1766026721777.raw_data#}}\\\
            n\\\n            è®¡ç®—å‡ºçš„é£Žé™©ï¼š{{#1766026721777.risk_tags#}}\\nè¯¦ç»†åˆ†æžï¼š{{#1766026721777.analysis#}}\\\
            n\\\n            \\nå¦‚æžœé£Žé™©æ ‡ç­¾åŒ…å«â€œæ­£å¸¸â€ï¼Œè¯·é¼“åŠ±ç”¨æˆ·ã€‚\\nå¦‚æžœåŒ…å«é£Žé™©ï¼ˆå¦‚é«˜è¡€åŽ‹ã€é«˜å°¿é…¸ï¼‰ï¼Œè¯·æŽ¨èå¯¹åº”çš„ã€ç”Ÿå‘½å«å£«é…æ–¹ã€‘ï¼ˆå¦‚ï¼šé™åŽ‹æŠ¤èˆªé…æ–¹ã€ç—›é£Žå¹²é¢„é…æ–¹ï¼‰ã€‚\\\
            n\\nè¯·ç”¨äº²åˆ‡ã€ä¸“ä¸šçš„å£å»å›žç­”ã€‚ä½¿ç”¨MarkdownæŽ’ç‰ˆã€‚\\n\\\n            å›žç­”ç»“æž„ï¼š\\n1. \U0001F4C9\
            \ å¥åº·çŽ°çŠ¶åˆ†æž\\n2. \U0001F48A æŽ¨èé…æ–¹ä¸Žé¥®é£Ÿ\\n3. \U0001F3C3 è¿åŠ¨å»ºè®®"
        selected: false
        title: ç”Ÿæˆå»ºè®®
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1766027016360'
      position:
        x: 992
        y: 282
      positionAbsolute:
        x: 992
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1766027016360'
          - text
          variable: text
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1766027040263'
      position:
        x: 1296
        y: 282
      positionAbsolute:
        x: 1296
        y: 282
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -134.8169487738162
      y: 23.390960936474755
      zoom: 0.8705505632961242
