<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务 --知识铺 | 知识铺的博客</title>
    <meta property="og:title" content="销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务 --知识铺 - 知识铺的博客">
    <meta property="og:type" content="article">
    
    <meta property="article:published_time" content='2025-10-25T03:50:45&#43;08:00'>
    
    
    <meta property="article:modified_time" content='2025-10-25T03:50:45&#43;08:00'>
    
    <meta name="Keywords" content="golang,go语言,go语言笔记,知识铺,java,android,博客,项目管理,python,软件架构,公众号,小程序">
    <meta name="description" content="销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务 --知识铺">
    
    <meta name="author" content="知识铺">
    <meta property="og:url" content="https://index.zshipu.com/ai002/post/20251025/sales-lead-distribution/">
    <link rel="shortcut icon" href='/ai002/favicon.ico' type="image/x-icon">

    <link rel="stylesheet" href='/ai002/css/normalize.css'>
    <link rel="stylesheet" href='/ai002/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    <script data-ad-client="ca-pub-2874221941555456" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    

    

    
    
    
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WLWJSST');</script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BY5XJ2PJ93"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-BY5XJ2PJ93');
    </script>
    
</head>

<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLWJSST"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://index.zshipu.com/ai002/">
                        知识铺的博客
                    </a>
                
                <p class="description">专注于Android、Java、Go语言(golang)、移动互联网、项目管理、软件架构</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://index.zshipu.com/ai002/">首页</a>
                    
                    <a  href="https://index.zshipu.com/ai001/" title="AI技术">AI技术</a>
                    
                    <a  href="https://index.zshipu.com" title="总站">总站</a>
                    
                    <a  href="https://index.zshipu.com/ai002/archives/" title="归档">归档</a>
                    
                    <a  href="https://index.zshipu.com/ai002/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#文章导读">文章导读</a></li>
    <li><a href="#一核心问题为什么需要自动化分发线索">一、核心问题：为什么需要自动化分发线索</a>
      <ul>
        <li><a href="#传统线索分发的痛点">传统线索分发的痛点</a></li>
        <li><a href="#自动化分发的价值">自动化分发的价值</a></li>
      </ul>
    </li>
    <li><a href="#二n8n-与飞书集成架构">二、n8n 与飞书集成架构</a>
      <ul>
        <li><a href="#n8n-平台简介">n8n 平台简介</a></li>
        <li><a href="#核心工作流元素">核心工作流元素</a></li>
        <li><a href="#飞书集成方案">飞书集成方案</a></li>
      </ul>
    </li>
    <li><a href="#三完整工作流设计">三、完整工作流设计</a>
      <ul>
        <li><a href="#31-整体架构">3.1 整体架构</a></li>
        <li><a href="#32-触发器配置webhook-接收线索">3.2 触发器配置：Webhook 接收线索</a></li>
        <li><a href="#33-数据过滤和清洗filter-节点">3.3 数据过滤和清洗：Filter 节点</a></li>
        <li><a href="#34-条件分支if-与-switch-节点进行多条件路由">3.4 条件分支：IF 与 Switch 节点进行多条件路由</a></li>
        <li><a href="#35-查询销售代表数据库查询节点">3.5 查询销售代表：数据库查询节点</a></li>
        <li><a href="#36-核心操作使用-http-request-创建飞书任务">3.6 核心操作：使用 HTTP Request 创建飞书任务</a></li>
        <li><a href="#37-发送通知feishu-bot-消息推送">3.7 发送通知：Feishu Bot 消息推送</a></li>
        <li><a href="#38-记录和监控数据存储和日志">3.8 记录和监控：数据存储和日志</a></li>
      </ul>
    </li>
    <li><a href="#四进阶特性智能分发算法">四、进阶特性：智能分发算法</a>
      <ul>
        <li><a href="#41-轮转分配round-robin">4.1 轮转分配（Round Robin）</a></li>
        <li><a href="#42-基于技能和专长的分配">4.2 基于技能和专长的分配</a></li>
        <li><a href="#43-线索评分和优先级">4.3 线索评分和优先级</a></li>
      </ul>
    </li>
    <li><a href="#五完整的工作流配置步骤">五、完整的工作流配置步骤</a>
      <ul>
        <li><a href="#第-1-步创建凭证">第 1 步：创建凭证</a></li>
        <li><a href="#第-2-步创建-workflow">第 2 步：创建 Workflow</a></li>
        <li><a href="#第-3-步添加节点">第 3 步：添加节点</a></li>
        <li><a href="#第-4-步连接节点">第 4 步：连接节点</a></li>
        <li><a href="#第-5-步测试工作流">第 5 步：测试工作流</a></li>
        <li><a href="#第-6-步激活并监控">第 6 步：激活并监控</a></li>
      </ul>
    </li>
    <li><a href="#六常见问题与最佳实践">六、常见问题与最佳实践</a>
      <ul>
        <li><a href="#61-常见问题">6.1 常见问题</a></li>
        <li><a href="#62-最佳实践">6.2 最佳实践</a></li>
      </ul>
    </li>
    <li><a href="#七成本效益分析">七、成本效益分析</a>
      <ul>
        <li><a href="#投入成本">投入成本</a></li>
        <li><a href="#预期收益">预期收益</a></li>
      </ul>
    </li>
    <li><a href="#八总结与展望">八、总结与展望</a>
      <ul>
        <li><a href="#核心价值">核心价值</a></li>
        <li><a href="#进一步的扩展">进一步的扩展</a></li>
      </ul>
    </li>
    <li><a href="#参考资源">参考资源</a></li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务 --知识铺</h1>
        </header>
        <date class="post-meta meta-date">
            2025年10月25日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h1 id="销售线索智能分发n8n-将线索按条件分配至飞书并创建任务">销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务</h1>
<h2 id="文章导读">文章导读</h2>
<p>在现代销售运营中，<strong>销售线索的快速、精准分发</strong>决定了团队的响应速度和转化率。本文介绍如何使用 n8n 开源工作流自动化平台，将来自各个渠道的销售线索按照特定条件智能分配到飞书，并自动创建任务。通过这套自动化系统，销售团队可以消除手动分配的低效，实现 7×24 小时的自动化运营。</p>
<hr>
<h2 id="一核心问题为什么需要自动化分发线索">一、核心问题：为什么需要自动化分发线索</h2>
<h3 id="传统线索分发的痛点">传统线索分发的痛点</h3>
<p>销售团队通常面临以下挑战：</p>
<p><strong>手动分配效率低</strong>：销售主管需要逐条查看线索信息，手动判断分配给哪个销售代表，容易出错且耗时。</p>
<p><strong>分发时间延迟</strong>：从线索进入系统到分配给销售代表的时间过长，错过黄金反应窗口（通常仅有 5-10 分钟）。</p>
<p><strong>分配不公平</strong>：难以实现公平的工作量分配，导致某些销售代表超负荷，而其他人相对空闲。</p>
<p><strong>跟踪困难</strong>：线索流向、处理状态难以追踪，管理层无法实时掌握运营数据。</p>
<p><strong>集成孤岛</strong>：销售数据散落在不同的系统中（CRM、表单、数据库等），难以统一管理。</p>
<h3 id="自动化分发的价值">自动化分发的价值</h3>
<p>通过 n8n 实现自动化分发，可以：</p>
<ul>
<li><strong>缩短响应时间</strong>：线索到达的瞬间就能自动分配和创建任务，通常可将响应时间从数小时降至秒级。</li>
<li><strong>提升转化率</strong>：根据研究，快速反应能将线索转化率提升 3-5 倍。</li>
<li><strong>降低成本</strong>：减少人工干预，销售主管可以专注于更高价值的工作。</li>
<li><strong>提高透明度</strong>：所有操作可追踪，便于分析和优化流程。</li>
<li><strong>支持复杂规则</strong>：支持按地域、产品、行业、线索等级等多维度条件进行分发。</li>
</ul>
<hr>
<h2 id="二n8n-与飞书集成架构">二、n8n 与飞书集成架构</h2>
<h3 id="n8n-平台简介">n8n 平台简介</h3>
<p><strong>n8n</strong> 是一个开源的工作流自动化平台，采用&quot;公平代码&quot;（Fair-Code）许可协议[6]。与 Zapier 和 Make 等收费平台相比，n8n 具有以下优势：</p>
<ul>
<li><strong>完全开源</strong>：代码公开透明，支持自部署，不依赖第三方服务。</li>
<li><strong>节点丰富</strong>：内置 300+ 的应用集成节点，覆盖绝大多数常见应用。</li>
<li><strong>可视化编排</strong>：通过拖拽鼠标连接节点，无需编程即可构建复杂流程。</li>
<li><strong>低代码扩展</strong>：支持 JavaScript/Python 代码节点，满足高级定制需求。</li>
</ul>
<h3 id="核心工作流元素">核心工作流元素</h3>
<p>在构建线索分发流程前，需要理解 n8n 的几个核心概念：</p>
<p><strong>触发器（Trigger）</strong>[7]：工作流的起点，设定条件满足后自动执行。常见触发方式包括：</p>
<ul>
<li>Webhook：接收来自外部应用的 HTTP 请求</li>
<li>定时触发（Cron）：按时间表自动执行</li>
<li>应用事件：监听特定应用的事件</li>
</ul>
<p><strong>节点（Node）</strong>[12]：工作流的执行单元，可进行数据处理、条件判断、API 调用等操作。</p>
<p><strong>连接（Connection）</strong>：节点间的数据流通路。n8n 按照画布位置从上到下执行，支持多分支并行处理。</p>
<h3 id="飞书集成方案">飞书集成方案</h3>
<p>飞书提供了完整的 OpenAPI 和集成生态，支持通过 n8n 进行自动化操作。主要集成方式包括：</p>
<ul>
<li><strong>HTTP Request 节点</strong>：通过 REST API 调用飞书开放平台，创建任务、发送消息等。</li>
<li><strong>飞书项目插件</strong>：开源的 n8n 自定义节点，支持 16 个功能模块和 73 个操作，覆盖工作项、空间、用户等完整功能[11]。</li>
<li><strong>Webhook 机器人</strong>：飞书的自定义机器人可接收 n8n 的通知和数据[15]。</li>
</ul>
<hr>
<h2 id="三完整工作流设计">三、完整工作流设计</h2>
<h3 id="31-整体架构">3.1 整体架构</h3>
<p>一个完整的线索智能分发系统包含以下阶段：</p>
<pre tabindex="0"><code>销售线索源 
  ↓
[Webhook 触发器] → 接收线索数据
  ↓
[过滤节点] → 数据验证和清洗
  ↓
[条件判断] → 按规则分类线索
  ↓
[分支路由] → 根据不同条件执行不同操作
  ↓
[创建飞书任务] → 在对应负责人名下创建任务
  ↓
[发送通知] → 通知相关销售代表和主管
  ↓
[记录日志] → 保存分配记录用于分析
</code></pre><h3 id="32-触发器配置webhook-接收线索">3.2 触发器配置：Webhook 接收线索</h3>
<p><strong>第一步：添加 Webhook 触发器</strong></p>
<ol>
<li>在 n8n 画布中添加一个&quot;On webhook call&quot;节点</li>
<li>系统会自动生成一个 Webhook URL，格式如：
<pre tabindex="0"><code>https://your-n8n-instance.com/webhook/xxxxxxxx
</code></pre></li>
<li>将此 URL 配置到销售表单、CRM 系统或其他线索来源</li>
</ol>
<p><strong>第二步：配置认证和测试</strong></p>
<ul>
<li>启用&quot;HTTP Basic Auth&quot;或&quot;Bearer Token&quot;以提高安全性</li>
<li>发送测试请求验证 Webhook 是否正常工作</li>
<li>查看&quot;Test&quot;tab 页面查看接收到的实际数据结构</li>
</ul>
<p><strong>典型的线索数据结构</strong>[27]：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;lead_id&#34;</span>: <span style="color:#d14">&#34;L20250115001&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;张三&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;phone&#34;</span>: <span style="color:#d14">&#34;13800138000&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;email&#34;</span>: <span style="color:#d14">&#34;zhangsan@company.com&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;company&#34;</span>: <span style="color:#d14">&#34;ABC科技有限公司&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;industry&#34;</span>: <span style="color:#d14">&#34;互联网&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;budget&#34;</span>: <span style="color:#d14">&#34;50万-100万&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;region&#34;</span>: <span style="color:#d14">&#34;华东地区&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;product_interest&#34;</span>: <span style="color:#d14">&#34;SaaS平台&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;lead_source&#34;</span>: <span style="color:#d14">&#34;官网表单&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;lead_score&#34;</span>: <span style="color:#099">85</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;created_at&#34;</span>: <span style="color:#d14">&#34;2025-01-15T09:30:00Z&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="33-数据过滤和清洗filter-节点">3.3 数据过滤和清洗：Filter 节点</h3>
<p>接收到线索后，需要进行数据验证，排除不合格的线索[67]：</p>
<ol>
<li><strong>添加 Filter 节点</strong>，连接到 Webhook 触发器之后</li>
<li><strong>设置过滤条件</strong>，例如：
<ul>
<li>线索必须包含电话或邮箱（确保能联系）</li>
<li>线索评分 ≥ 50 分（排除低质线索）</li>
<li>公司名称不为空（B2B 模式）</li>
<li>不是已重复的线索</li>
</ul>
</li>
</ol>
<p><strong>Filter 节点配置示例</strong>：</p>
<pre tabindex="0"><code>条件1: phone 字段 不为空
AND
条件2: lead_score ≥ 50
AND
条件3: company 字段 不为空
</code></pre><h3 id="34-条件分支if-与-switch-节点进行多条件路由">3.4 条件分支：IF 与 Switch 节点进行多条件路由</h3>
<p>线索需要按照不同的维度进行分类和分发。n8n 提供两个主要的条件节点：</p>
<h4 id="使用-if-节点进行二分支判断">使用 IF 节点进行二分支判断</h4>
<p>IF 节点用于简单的真/假分支[21][22]，如按地域进行初步划分：</p>
<p><strong>配置示例</strong>：</p>
<pre tabindex="0"><code>条件: region = &#34;华东地区&#34;
├─ 真分支 → 发送给华东区销售团队
└─ 假分支 → 发送给其他区域销售团队
</code></pre><h4 id="使用-switch-节点进行多分支路由">使用 Switch 节点进行多分支路由</h4>
<p>当需要进行复杂的多条件路由时，使用 Switch 节点比嵌套多个 IF 节点更清晰[21][37]。</p>
<p><strong>Switch 节点的优势</strong>：</p>
<ul>
<li>支持无限数量的分支路由</li>
<li>规则从上到下依次评估，一旦匹配立即执行，跳过后续规则</li>
<li>代码复杂度降低 60%，相比嵌套 IF 语句[37]</li>
</ul>
<p><strong>完整的线索分发规则设计</strong>：</p>
<pre tabindex="0"><code>规则1: 如果 region = &#34;华东地区&#34; &amp;&amp; lead_score ≥ 80
  → 输出键: &#34;high_quality_east&#34;
  → 分配给: 高级销售代表（华东）
  
规则2: 如果 region = &#34;华东地区&#34; &amp;&amp; lead_score &lt; 80
  → 输出键: &#34;normal_east&#34;
  → 分配给: 普通销售代表（华东）
  
规则3: 如果 region = &#34;华北地区&#34; &amp;&amp; product_interest = &#34;企业版&#34;
  → 输出键: &#34;enterprise_north&#34;
  → 分配给: 企业销售团队（华北）
  
规则4: 如果 industry = &#34;金融&#34; &amp;&amp; budget ≥ 100万
  → 输出键: &#34;finance_large_deal&#34;
  → 分配给: 行业专家（金融）
  
默认规则: 其他线索
  → 输出键: &#34;default&#34;
  → 分配给: 通用销售队列
</code></pre><h3 id="35-查询销售代表数据库查询节点">3.5 查询销售代表：数据库查询节点</h3>
<p>为了实现动态的销售代表分配，需要建立一个销售代表的数据库或映射关系。</p>
<p><strong>方案一：使用 Spreadsheet 节点</strong></p>
<p>如果团队规模较小，可以维护一个 Google Sheets 或 Airtable 的销售代表列表：</p>
<pre tabindex="0"><code>地区    | 销售代表    | 飞书用户ID  | 最近分配数 | 状态
华东区  | 李四      | user_001    | 12        | 在线
华东区  | 王五      | user_002    | 8         | 在线
华北区  | 赵六      | user_003    | 15        | 离线
</code></pre><p><strong>方案二：使用 MySQL/PostgreSQL 数据库</strong></p>
<p>对于中大型团队，可以连接到企业数据库，支持更复杂的查询逻辑。</p>
<p><strong>方案三：使用 HTTP Request 调用飞书 API 查询用户</strong></p>
<p>通过飞书的 OpenAPI，可以实时查询部门成员和在线状态：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 调用飞书 API 获取部门成员
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>GET <span style="color:#000;font-weight:bold">/</span>open<span style="color:#000;font-weight:bold">-</span>apis<span style="color:#000;font-weight:bold">/</span>contact<span style="color:#000;font-weight:bold">/</span>v3<span style="color:#000;font-weight:bold">/</span>departments<span style="color:#000;font-weight:bold">/</span>{department_id}<span style="color:#000;font-weight:bold">/</span>members
</span></span><span style="display:flex;"><span>Authorization<span style="color:#000;font-weight:bold">:</span> Bearer {tenant_access_token}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="36-核心操作使用-http-request-创建飞书任务">3.6 核心操作：使用 HTTP Request 创建飞书任务</h3>
<p>这是整个流程的核心，需要通过 n8n 的 HTTP Request 节点调用飞书任务创建 API[39]。</p>
<h4 id="获取飞书认证凭证">获取飞书认证凭证</h4>
<ol>
<li>
<p><strong>获取 Tenant Access Token</strong>：</p>
<ul>
<li>到飞书开放平台创建自建应用</li>
<li>获取 App ID 和 App Secret</li>
<li>在 n8n 中创建&quot;Credentials&quot;存储这些秘钥</li>
</ul>
</li>
<li>
<p><strong>配置凭证</strong>：</p>
</li>
</ol>
<pre tabindex="0"><code>Credential Type: Custom
Base URL: https://open.feishu.cn
Auth Type: Bearer Token
Token: {tenant_access_token}
</code></pre><h4 id="http-request-节点配置">HTTP Request 节点配置</h4>
<p><strong>基本配置</strong>：</p>
<table>
<thead>
<tr>
<th>配置项</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>请求类型</td>
<td>POST</td>
</tr>
<tr>
<td>URL</td>
<td><a href="https://open.feishu.cn/open-apis/task/v2/tasks">https://open.feishu.cn/open-apis/task/v2/tasks</a></td>
</tr>
<tr>
<td>认证方式</td>
<td>Bearer Token（使用创建的凭证）</td>
</tr>
</tbody>
</table>
<p><strong>请求体（JSON）</strong>：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;summary&#34;</span>: <span style="color:#d14">&#34;跟进线索：{{ $json.name }} - {{ $json.company }}&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;description&#34;</span>: <span style="color:#d14">&#34;客户信息：\n电话：{{ $json.phone }}\n邮箱：{{ $json.email }}\n行业：{{ $json.industry }}\n预算：{{ $json.budget }}\n产品兴趣：{{ $json.product_interest }}\n线索来源：{{ $json.lead_source }}\n线索评分：{{ $json.lead_score }}&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;due&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;time&#34;</span>: <span style="color:#d14">&#34;{{ $now.toISOString() }}&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;is_all_day&#34;</span>: <span style="color:#000;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;assignees&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;id&#34;</span>: <span style="color:#d14">&#34;{{ $json.sales_rep_feishu_id }}&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;custom_fields&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;field_id&#34;</span>: <span style="color:#d14">&#34;phone&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;value&#34;</span>: <span style="color:#d14">&#34;{{ $json.phone }}&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;field_id&#34;</span>: <span style="color:#d14">&#34;company&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;value&#34;</span>: <span style="color:#d14">&#34;{{ $json.company }}&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;field_id&#34;</span>: <span style="color:#d14">&#34;lead_score&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;value&#34;</span>: <span style="color:#d14">&#34;{{ $json.lead_score }}&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>关键字段说明</strong>：</p>
<ul>
<li><code>summary</code>：任务标题，使用模板语法 <code>{{ }}</code> 引入线索数据</li>
<li><code>description</code>：详细描述，包含完整的线索信息，方便销售代表快速了解</li>
<li><code>due.time</code>：截止时间，建议根据线索等级设置（高端线索 2 小时，普通 24 小时）</li>
<li><code>assignees</code>：指派给的销售代表，使用飞书用户 ID</li>
<li><code>custom_fields</code>：自定义字段，用于扩展信息存储</li>
</ul>
<h4 id="处理-api-响应">处理 API 响应</h4>
<p>飞书任务创建 API 成功响应示例：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;code&#34;</span>: <span style="color:#099">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;msg&#34;</span>: <span style="color:#d14">&#34;success&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;data&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;task_id&#34;</span>: <span style="color:#d14">&#34;123456789&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;created_at&#34;</span>: <span style="color:#099">1642000000</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>在 HTTP Request 节点之后，添加一个 JavaScript 代码节点提取任务 ID：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>  task_id<span style="color:#000;font-weight:bold">:</span> $json.data.task_id,
</span></span><span style="display:flex;"><span>  task_url<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">`https://feishu.feishu.cn/tasks/</span><span style="color:#d14">${</span>$json.data.task_id<span style="color:#d14">}</span><span style="color:#d14">`</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="37-发送通知feishu-bot-消息推送">3.7 发送通知：Feishu Bot 消息推送</h3>
<p>线索分配完成后，应该立即通知相关方。可以通过飞书机器人发送消息[15]。</p>
<h4 id="配置飞书自定义机器人">配置飞书自定义机器人</h4>
<ol>
<li>在飞书群组中添加自定义机器人</li>
<li>获取 Webhook 地址</li>
<li>在 n8n 中保存为凭证</li>
</ol>
<h4 id="发送消息给销售代表">发送消息给销售代表</h4>
<p>使用 HTTP Request 节点调用机器人 Webhook：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;msg_type&#34;</span>: <span style="color:#d14">&#34;post&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;content&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&#34;post&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&#34;zh_cn&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;title&#34;</span>: <span style="color:#d14">&#34;新线索已分配给你&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&#34;content&#34;</span>: [
</span></span><span style="display:flex;"><span>          [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;text&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;客户：&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;text&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;{{ $json.name }}&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;style&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#000080">&#34;bold&#34;</span>: <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;text&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;公司：&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;text&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;{{ $json.company }}&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;text&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;电话：&#34;</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;text&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;{{ $json.phone }}&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;tag&#34;</span>: <span style="color:#d14">&#34;button&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;查看任务&#34;</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#000080">&#34;url&#34;</span>: <span style="color:#d14">&#34;{{ $json.task_url }}&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ]
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="发送汇总报告给主管">发送汇总报告给主管</h4>
<p>每小时或每天生成一份分配汇总报告，发送给销售主管：</p>
<ul>
<li>本期分配线索总数</li>
<li>按销售代表的分配数量</li>
<li>不同等级线索的分布</li>
<li>平均分配响应时间</li>
</ul>
<h3 id="38-记录和监控数据存储和日志">3.8 记录和监控：数据存储和日志</h3>
<p>为了后续的分析和优化，需要记录每一条线索的分配过程。</p>
<h4 id="保存到-google-sheets">保存到 Google Sheets</h4>
<p>通过 Google Sheets 节点记录完整的分配历史：</p>
<pre tabindex="0"><code>时间戳 | 线索ID | 客户名称 | 销售代表 | 任务ID | 响应时间 | 分配规则
</code></pre><h4 id="保存到数据库">保存到数据库</h4>
<p>建议保存到 MySQL/PostgreSQL，便于后续做数据分析和 BI 展示：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>lead_distribution_log<span style="color:#bbb"> </span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>id<span style="color:#bbb"> </span><span style="color:#0086b3">INT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">PRIMARY</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">KEY</span><span style="color:#bbb"> </span>AUTO_INCREMENT,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>lead_id<span style="color:#bbb"> </span><span style="color:#0086b3">VARCHAR</span>(<span style="color:#099">50</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>customer_name<span style="color:#bbb"> </span><span style="color:#0086b3">VARCHAR</span>(<span style="color:#099">100</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>sales_rep_id<span style="color:#bbb"> </span><span style="color:#0086b3">VARCHAR</span>(<span style="color:#099">50</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>task_id<span style="color:#bbb"> </span><span style="color:#0086b3">VARCHAR</span>(<span style="color:#099">100</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>assigned_at<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TIMESTAMP</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>response_time_ms<span style="color:#bbb"> </span><span style="color:#0086b3">INT</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>distribution_rule<span style="color:#bbb"> </span><span style="color:#0086b3">VARCHAR</span>(<span style="color:#099">100</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>created_at<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TIMESTAMP</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">DEFAULT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">CURRENT_TIMESTAMP</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>);<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="四进阶特性智能分发算法">四、进阶特性：智能分发算法</h2>
<h3 id="41-轮转分配round-robin">4.1 轮转分配（Round Robin）</h3>
<p>确保所有销售代表获得公平的工作量分配[51]：</p>
<ol>
<li>维护一个计数器，记录每个销售代表最近被分配的线索数</li>
<li>每次分配时，选择计数器最低的代表</li>
<li>分配后递增该代表的计数器</li>
</ol>
<p><strong>实现方案</strong>：</p>
<p>在 Code 节点中编写逻辑：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 假设已有销售代表列表及其分配数
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">const</span> salesReps <span style="color:#000;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>  { id<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;user_001&#39;</span>, assigned_count<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">12</span>, name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;李四&#39;</span> },
</span></span><span style="display:flex;"><span>  { id<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;user_002&#39;</span>, assigned_count<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">8</span>, name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;王五&#39;</span> },
</span></span><span style="display:flex;"><span>  { id<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;user_003&#39;</span>, assigned_count<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">15</span>, name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;赵六&#39;</span> }
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 选择分配数最少的代表
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">const</span> selectedRep <span style="color:#000;font-weight:bold">=</span> salesReps.reduce((prev, curr) =&gt; 
</span></span><span style="display:flex;"><span>  prev.assigned_count <span style="color:#000;font-weight:bold">&lt;</span> curr.assigned_count <span style="color:#000;font-weight:bold">?</span> prev <span style="color:#000;font-weight:bold">:</span> curr
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>  sales_rep_id<span style="color:#000;font-weight:bold">:</span> selectedRep.id,
</span></span><span style="display:flex;"><span>  sales_rep_name<span style="color:#000;font-weight:bold">:</span> selectedRep.name
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="42-基于技能和专长的分配">4.2 基于技能和专长的分配</h3>
<p>不同销售代表具有不同的专长，应根据线索特征匹配合适的代表：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> skillMatrix <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;user_001&#39;</span><span style="color:#000;font-weight:bold">:</span> { industries<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#39;互联网&#39;</span>, <span style="color:#d14">&#39;金融&#39;</span>], max_deal_size<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;100万&#39;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;user_002&#39;</span><span style="color:#000;font-weight:bold">:</span> { industries<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#39;制造业&#39;</span>, <span style="color:#d14">&#39;房地产&#39;</span>], max_deal_size<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;50万&#39;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;user_003&#39;</span><span style="color:#000;font-weight:bold">:</span> { industries<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#39;互联网&#39;</span>, <span style="color:#d14">&#39;教育&#39;</span>], max_deal_size<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;200万&#39;</span> }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 根据线索行业和预算选择合适的代表
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">const</span> lead <span style="color:#000;font-weight:bold">=</span> $json;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">const</span> suitableReps <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">Object</span>.entries(skillMatrix)
</span></span><span style="display:flex;"><span>  .filter(([id, skills]) =&gt; 
</span></span><span style="display:flex;"><span>    skills.industries.includes(lead.industry)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>  .map(([id]) =&gt; id);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>  suitable_reps<span style="color:#000;font-weight:bold">:</span> suitableReps,
</span></span><span style="display:flex;"><span>  recommended_rep<span style="color:#000;font-weight:bold">:</span> suitableReps[<span style="color:#099">0</span>]
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="43-线索评分和优先级">4.3 线索评分和优先级</h3>
<p>根据线索的多维度评分动态调整处理优先级：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">let</span> score <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 来源权重
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">const</span> sourceWeights <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;官网表单&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">30</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;广告转化&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">25</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;推荐&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">40</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;外购&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">10</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>score <span style="color:#000;font-weight:bold">+=</span> sourceWeights[$json.lead_source] <span style="color:#000;font-weight:bold">||</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 预算权重
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">const</span> budgetScore <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;10万以下&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">10</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;10万-50万&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">25</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;50万-100万&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">40</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;100万以上&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">50</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>score <span style="color:#000;font-weight:bold">+=</span> budgetScore[$json.budget] <span style="color:#000;font-weight:bold">||</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 行业权重（针对不同企业）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">const</span> industryWeights <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;互联网&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">30</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;金融&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">35</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;制造业&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">20</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>score <span style="color:#000;font-weight:bold">+=</span> industryWeights[$json.industry] <span style="color:#000;font-weight:bold">||</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// 确定优先级
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">let</span> priority <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;low&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> (score <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">80</span>) priority <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;urgent&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> (score <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">60</span>) priority <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;high&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> (score <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">40</span>) priority <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>  lead_score<span style="color:#000;font-weight:bold">:</span> score,
</span></span><span style="display:flex;"><span>  priority<span style="color:#000;font-weight:bold">:</span> priority
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="五完整的工作流配置步骤">五、完整的工作流配置步骤</h2>
<h3 id="第-1-步创建凭证">第 1 步：创建凭证</h3>
<ol>
<li>点击 n8n 菜单中的&quot;Credentials&quot;</li>
<li>创建&quot;飞书开放平台&quot;凭证，保存 App ID、App Secret</li>
<li>创建&quot;HTTP Basic Auth&quot;凭证（如果需要保护 Webhook）</li>
</ol>
<h3 id="第-2-步创建-workflow">第 2 步：创建 Workflow</h3>
<ol>
<li>新建 Workflow，命名为&quot;Sales Lead Distribution&quot;</li>
<li>添加&quot;On webhook call&quot;触发器作为起点</li>
</ol>
<h3 id="第-3-步添加节点">第 3 步：添加节点</h3>
<p>按照以下顺序添加节点：</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>节点类型</th>
<th>功能</th>
<th>配置说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Webhook Trigger</td>
<td>接收线索</td>
<td>设置认证、获取 URL</td>
</tr>
<tr>
<td>2</td>
<td>Filter</td>
<td>数据验证</td>
<td>过滤空值、低分线索</td>
</tr>
<tr>
<td>3</td>
<td>Code</td>
<td>数据转换</td>
<td>标准化字段格式</td>
</tr>
<tr>
<td>4</td>
<td>Switch</td>
<td>多条件路由</td>
<td>按地域、行业、预算分类</td>
</tr>
<tr>
<td>5</td>
<td>HTTP Request</td>
<td>查询销售代表</td>
<td>调用数据库或 API</td>
</tr>
<tr>
<td>6</td>
<td>HTTP Request</td>
<td>创建飞书任务</td>
<td>调用飞书任务 API</td>
</tr>
<tr>
<td>7</td>
<td>HTTP Request</td>
<td>发送机器人通知</td>
<td>通知销售代表和主管</td>
</tr>
<tr>
<td>8</td>
<td>Google Sheets</td>
<td>记录日志</td>
<td>保存分配历史</td>
</tr>
</tbody>
</table>
<h3 id="第-4-步连接节点">第 4 步：连接节点</h3>
<p>在画布中连接节点，确保数据流正确传递。多个分支可以并行执行。</p>
<h3 id="第-5-步测试工作流">第 5 步：测试工作流</h3>
<ol>
<li>点击&quot;Test Workflow&quot;或使用&quot;Execute Workflow&quot;</li>
<li>发送示例线索数据到 Webhook URL</li>
<li>检查每个节点的输出，验证数据转换和路由正确性</li>
<li>确认飞书任务成功创建</li>
</ol>
<h3 id="第-6-步激活并监控">第 6 步：激活并监控</h3>
<ol>
<li>启用&quot;Active&quot;开关，工作流开始运行</li>
<li>在&quot;Executions&quot;标签页查看运行日志</li>
<li>定期检查执行状态，排查错误</li>
</ol>
<hr>
<h2 id="六常见问题与最佳实践">六、常见问题与最佳实践</h2>
<h3 id="61-常见问题">6.1 常见问题</h3>
<p><strong>Q1：线索数据从何而来？</strong></p>
<p>常见的线索源包括：</p>
<ul>
<li>官网表单（POST 到 Webhook）</li>
<li>CRM 系统（通过 API 推送）</li>
<li>营销自动化平台（HubSpot、Marketo 等）</li>
<li>第三方数据服务</li>
<li>手动导入的 CSV 文件</li>
</ul>
<p><strong>Q2：如何处理重复线索？</strong></p>
<p>在 Filter 节点之前添加一个&quot;Remove Duplicates&quot;节点，或在 Code 节点中实现去重逻辑，通过手机号或邮箱进行匹配。</p>
<p><strong>Q3：线索分配失败如何处理？</strong></p>
<p>添加&quot;Error Handling&quot;机制，使用&quot;Try-Catch&quot;模式：</p>
<ul>
<li>如果创建任务失败，发送告警给管理员</li>
<li>将失败的线索保存到待处理队列，稍后重试</li>
<li>记录错误日志便于排查</li>
</ul>
<p><strong>Q4：如何支持多语言？</strong></p>
<p>使用条件节点判断线索的地区或语言字段，动态加载不同语言的任务描述和消息模板。</p>
<p><strong>Q5：性能如何保证？</strong></p>
<ul>
<li>n8n 采用事件驱动架构，可支持每秒数百条线索的处理</li>
<li>对于超大规模（日均 10 万+ 线索），建议使用专业版或企业版的 n8n Cloud</li>
<li>在数据库查询前添加缓存层，避免重复查询销售代表信息</li>
</ul>
<h3 id="62-最佳实践">6.2 最佳实践</h3>
<p><strong>1. 定期审计和优化分发规则</strong></p>
<ul>
<li>每周分析分配数据，检查规则是否公平合理</li>
<li>监控销售代表的成交率，调整权重分配</li>
<li>定期更新销售代表的技能矩阵</li>
</ul>
<p><strong>2. 确保数据安全</strong></p>
<ul>
<li>线索数据中可能包含个人隐私信息，确保 n8n 服务器安全</li>
<li>使用 HTTPS 协议传输数据</li>
<li>定期备份工作流配置和日志数据</li>
<li>遵守 GDPR 和当地数据保护法规</li>
</ul>
<p><strong>3. 建立监控告警</strong></p>
<ul>
<li>设置工作流执行失败的告警机制</li>
<li>监控 Webhook 请求延迟，超过阈值发送告警</li>
<li>统计线索分配的错误率，超过 5% 时暂停并检查</li>
</ul>
<p><strong>4. 文档和培训</strong></p>
<ul>
<li>记录所有分发规则的业务逻辑</li>
<li>对销售团队进行培训，说明自动分配机制</li>
<li>建立反馈机制，定期收集销售团队的建议</li>
</ul>
<p><strong>5. 逐步扩展功能</strong></p>
<ul>
<li>先实现基本的分配功能，确保稳定运行</li>
<li>根据使用经验，逐步添加高级功能（如智能评分、技能匹配）</li>
<li>从一个销售团队开始试点，经验成熟后推广到其他部门</li>
</ul>
<hr>
<h2 id="七成本效益分析">七、成本效益分析</h2>
<h3 id="投入成本">投入成本</h3>
<table>
<thead>
<tr>
<th>项目</th>
<th>成本</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>n8n 自部署</td>
<td>0</td>
<td>开源免费，仅需服务器成本</td>
</tr>
<tr>
<td>n8n Cloud</td>
<td>0-99$/月</td>
<td>云托管方案</td>
</tr>
<tr>
<td>飞书企业版</td>
<td>按用户计费</td>
<td>通常 50-200$/年/人</td>
</tr>
<tr>
<td>开发实施</td>
<td>5000-20000</td>
<td>一次性实施成本</td>
</tr>
<tr>
<td>维护运营</td>
<td>1000-3000/月</td>
<td>工作流维护、规则优化</td>
</tr>
</tbody>
</table>
<h3 id="预期收益">预期收益</h3>
<p><strong>以一个 10 人销售团队为例</strong>：</p>
<ul>
<li><strong>响应时间</strong>：从平均 30 分钟降至 10 秒，提升 <strong>99.4%</strong></li>
<li><strong>转化率提升</strong>：根据业界数据，快速响应能将线索转化率提升 <strong>30-50%</strong></li>
<li><strong>工作效率</strong>：销售主管工作时间节省 <strong>80%</strong>（从手动分配转向战略优化）</li>
<li><strong>公平性</strong>：销售代表工作量分配差异从 <strong>40%</strong> 降至 <strong>5%</strong></li>
</ul>
<p><strong>财务模型</strong>（月度）：</p>
<p>假设：</p>
<ul>
<li>月均 2000 条销售线索</li>
<li>平均客户生命周期价值 5 万元</li>
<li>转化率提升 40%</li>
<li>当前成交率 15%</li>
</ul>
<p>优化前：2000 × 15% = 300 单，收入 1500 万
优化后：2000 × 15% × 1.4 = 420 单，收入 2100 万</p>
<p><strong>额外收入：600 万/月</strong></p>
<p>投资回报率（ROI）：</p>
<ul>
<li>年度成本：20,000（初期） + 36,000（维护） = 56,000</li>
<li>年度收益增加：600 万 × 12 = 7200 万</li>
<li><strong>ROI = 12,857%</strong>（第一年）</li>
</ul>
<hr>
<h2 id="八总结与展望">八、总结与展望</h2>
<p>通过 n8n 和飞书的集成，销售企业可以构建一个<strong>完全自动化、高效智能的线索分发系统</strong>。这个系统不仅提升了运营效率，更重要的是释放了人工成本，让销售团队专注于高价值的客户沟通和成交。</p>
<h3 id="核心价值">核心价值</h3>
<p>✓ <strong>秒级响应</strong>：线索到达的瞬间自动分配，抢占竞争机会</p>
<p>✓ <strong>智能分配</strong>：基于多维度条件进行个性化路由，提升成交率</p>
<p>✓ <strong>公平透明</strong>：工作量均衡分配，增强团队满意度</p>
<p>✓ <strong>可持续优化</strong>：完整的数据记录和分析，驱动持续改进</p>
<p>✓ <strong>成本高效</strong>：开源方案，投资回报率超 12000%</p>
<h3 id="进一步的扩展">进一步的扩展</h3>
<ul>
<li><strong>与 AI 结合</strong>：使用 GPT 进行自动的线索预热和邮件撰写</li>
<li><strong>实时仪表板</strong>：构建 Metabase 或 Superset 仪表板，实时展示分配数据</li>
<li><strong>多渠道集成</strong>：支持 WhatsApp、钉钉、企业微信等多个工作平台</li>
<li><strong>预测分析</strong>：使用机器学习预测线索的成交概率，动态调整分配权重</li>
</ul>
<hr>
<h2 id="参考资源">参考资源</h2>
<ul>
<li>n8n 官方文档：https://docs.n8n.io</li>
<li>飞书开放平台：https://open.feishu.cn</li>
<li>n8n 中文社区：https://n8n.akashio.com</li>
<li>Feishu Project n8n 插件：https://github.com/luka-mimi/n8n-nodes-feishu-project</li>
</ul>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://index.zshipu.com/ai002/">知识铺</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://index.zshipu.com/ai002/post/20251025/sales-lead-distribution/">https://index.zshipu.com/ai002/post/20251025/sales-lead-distribution/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
        <li><strong>免责声明：</strong>本页面内容均来源于站内编辑发布，部分信息来源互联网，并不意味着本站赞同其观点或者证实其内容的真实性，如涉及版权等问题，请立即联系客服进行更改或删除，保证您的合法权益。转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。也可以邮件至 sblig@126.com</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/ai002/post/20251025/%E9%87%87%E8%B4%AD%E4%B8%8E%E9%87%87%E8%B4%AD%E5%8D%95%E6%B5%81%E7%A8%8B%E5%85%A8%E6%B5%81%E7%A8%8B%E8%87%AA%E5%8A%A8%E5%8C%96%E9%A3%9E%E4%B9%A6%E6%B5%81%E7%A8%8B%E5%9B%BE%E4%B8%8En8n%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97/">采购与采购单流程全流程自动化：飞书流程图与n8n实践指南 --知识铺</a></li>
        
        <li><a href="/ai002/post/20251025/%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86%E9%97%AD%E7%8E%AF%E9%A3%9E%E4%B9%A6%E7%9F%A5%E8%AF%86%E5%BA%93%E5%85%A5%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%8C%96%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%BD%92%E6%A1%A3/">知识管理闭环：飞书知识库入口自动化创建与归档 --知识铺</a></li>
        
        <li><a href="/ai002/post/20251025/%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9B%B4%E6%96%B0%E9%A3%9E%E4%B9%A6%E6%97%A5%E5%8E%86_%E7%BE%A4%E8%81%8A%E4%B8%8E%E4%BB%BB%E5%8A%A1%E7%8A%B6%E6%80%81%E6%89%AB%E6%8F%8F/">项目文档自动化更新：飞书日历_群聊与任务状态扫描 --知识铺</a></li>
        
        <li><a href="/ai002/post/20251025/%E8%90%A5%E9%94%80%E7%9B%91%E6%8E%A7%E7%9C%8B%E6%9D%BF%E7%94%A8-n8n-%E6%8A%BD%E5%8F%96%E7%A4%BE%E5%AA%92%E6%95%B0%E6%8D%AE%E5%B9%B6%E7%94%9F%E6%88%90%E9%A3%9E%E4%B9%A6%E6%8A%A5%E8%A1%A8/">营销监控看板：用 n8n 抽取社媒数据并生成飞书报表 --知识铺</a></li>
        
        <li><a href="/ai002/post/20251025/%E5%AE%A2%E6%88%B7%E6%9C%8D%E5%8A%A1%E8%B4%B4%E5%BF%83%E4%B8%AD%E5%BF%83n8n%E8%A7%A6%E5%8F%91%E9%A3%9E%E4%B9%A6%E5%AE%A2%E6%9C%8D%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%A4%84%E7%90%86%E5%B7%A5%E5%8D%95/">客户服务贴心中心：n8n触发飞书客服机器人处理工单 --知识铺</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            没有标签
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "zshipu/zshipu-index"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2025 <a href="https://index.zshipu.com/ai002/">知识铺的博客 By 知识铺</a>
        
        | <a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/">浙 ICP 备19032823号-1</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/ai002/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://index.zshipu.com/ai002/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://index.zshipu.com/ai002/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/AI_Industry_News_Analysis/" title="AI 产业周报：模型创新加速，行业竞争白热化 --知识铺">AI 产业周报：模型创新加速，行业竞争白热化 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/%E5%AE%A2%E6%88%B7%E6%88%90%E5%8A%9F%E8%BF%90%E8%90%A5%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%A3%9E%E4%B9%A6%E5%A4%9A%E7%BB%B4%E8%A1%A8%E6%A0%BC%E4%B8%8E-n8n-%E7%9A%84%E6%95%B0%E6%8D%AE%E8%81%94%E5%8A%A8/" title="客户成功运营仪表盘：飞书多维表格与 n8n 的数据联动 --知识铺">客户成功运营仪表盘：飞书多维表格与 n8n 的数据联动 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/N8N-%E8%87%AA%E5%AA%92%E4%BD%93%E8%87%AA%E5%8A%A8%E5%8C%96%E8%90%BD%E5%9C%B0%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/" title="N8N 自媒体自动化落地详细教程 --知识铺">N8N 自媒体自动化落地详细教程 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/%E5%86%85%E5%AE%B9%E5%88%9B%E4%BD%9C%E8%80%85%E8%89%AF%E5%A5%BD%E5%B9%B3%E5%8F%B0n8n-%E6%8F%90%E5%8F%96%E7%B4%A0%E6%9D%90%E5%85%83%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%9B%B4%E6%96%B0%E9%A3%9E%E4%B9%A6%E7%9F%A5%E8%AF%86%E5%BA%93_%E8%A1%A8%E6%A0%BC_%E5%86%99%E4%B8%80%E7%AF%87%E9%AB%98%E8%B4%A8%E9%87%8F%E6%96%87%E7%AB%A0/" title="内容创作者良好平台：n8n 提取素材元数据并更新飞书知识库_表格_写一篇高质量文章 --知识铺">内容创作者良好平台：n8n 提取素材元数据并更新飞书知识库_表格_写一篇高质量文章 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/n8n-%E5%90%8C%E6%AD%A5%E9%A3%9E%E4%B9%A6%E5%85%AC%E5%91%8A%E4%B8%8E%E6%97%A5%E6%8A%A5%E7%94%9F%E6%88%90%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/" title="n8n 同步飞书公告与日报生成详细教程 --知识铺">n8n 同步飞书公告与日报生成详细教程 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/%E5%86%85%E5%AE%B9%E5%88%9B%E4%BD%9C%E8%80%85%E7%9A%84%E6%99%BA%E8%83%BD%E5%B9%B3%E5%8F%B0n8n%E6%8F%90%E5%8F%96%E7%B4%A0%E6%9D%90%E5%85%83%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%9B%B4%E6%96%B0%E9%A3%9E%E4%B9%A6%E7%9F%A5%E8%AF%86%E5%BA%93_%E8%A1%A8%E6%A0%BC/" title="内容创作者的智能平台：n8n提取素材元数据并更新飞书知识库_表格 --知识铺">内容创作者的智能平台：n8n提取素材元数据并更新飞书知识库_表格 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/%E8%BF%90%E8%90%A5%E6%95%B0%E6%8D%AE%E5%BC%82%E5%B8%B8%E7%9B%91%E6%8E%A7n8n-%E5%AE%9E%E6%97%B6%E9%A2%84%E8%AD%A6%E4%B8%8E%E9%A3%9E%E4%B9%A6%E9%9B%86%E6%88%90/" title="运营数据异常监控：n8n 实时预警与飞书集成 --知识铺">运营数据异常监控：n8n 实时预警与飞书集成 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/%E4%BA%8B%E4%BB%B6_%E5%85%AC%E5%91%8A%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83%E4%B8%8E%E8%BF%BD%E8%B8%AAn8n-%E5%B0%86%E4%BA%8B%E4%BB%B6%E4%BF%A1%E6%81%AF%E4%B8%BB%E5%8A%A8%E6%8E%A8%E9%80%81%E8%87%B3%E9%A3%9E%E4%B9%A6%E5%B9%B6%E7%9B%91%E6%8E%A7%E5%8F%8D%E9%A6%88/" title="事件_公告自动发布与追踪：n8n 将事件信息主动推送至飞书并监控反馈 --知识铺">事件_公告自动发布与追踪：n8n 将事件信息主动推送至飞书并监控反馈 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/n8n_training_distribution/" title="内部培训通知与材料分发：使用n8n实现飞书自动化流程 --知识铺">内部培训通知与材料分发：使用n8n实现飞书自动化流程 --知识铺</a>
    </li>
    
    <li>
        <a href="https://index.zshipu.com/ai002/post/20251025/sales-lead-distribution/" title="销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务 --知识铺">销售线索智能分发：n8n 将线索按条件分配至飞书并创建任务 --知识铺</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">福利派送</h3>
    <ul class="widget-list">
        
        <li>
            <a href="https://pplx.ai/sblig3912" title="一起上 Comet，AI 工具免费用还送钱～" target="_blank" style="color:red">
                
                    <img src="https://cdn.jsdelivr.net/gh/zshipu/images/2025/202510250843697.png">
                
            </a>
        </li>
        
        <li>
            <a href="https://pplx.ai/sblig3912" title="邀请有礼 🎁 一起用 Comet，AI 助你更高效还送钱！" target="_blank" style="color:red">
                
                    <img src="https://cdn.jsdelivr.net/gh/zshipu/images/2025/202510250850822.png">
                
            </a>
        </li>
        
        <li>
            <a href="https://pplx.ai/sblig3912" title="AI 工具真香！我用的 Comet 免费送一个月 Pro～" target="_blank" style="color:red">
                
                    <img src="https://cdn.jsdelivr.net/gh/zshipu/images/2025/202510250851688.png">
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title"><a href='/ai002/categories/'>分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/ai002/tags/'>标签</a></h3>
<div class="tagcloud">
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://blog.zshipu.com//" title="知识铺的博客">知识铺的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://index.zshipu.com/ai002/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>